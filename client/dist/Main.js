// Generated by psc version 0.6.2
var PS = PS || {};
PS.Prelude = (function () {
    "use strict";
    function cons(e) {  return function(l) {    return [e].concat(l);  };};
    function refEq(r1) {  return function(r2) {    return r1 === r2;  };};
    function refIneq(r1) {  return function(r2) {    return r1 !== r2;  };};
    function boolAnd(b1) {  return function(b2) {    return b1 && b2;  };};
    function boolOr(b1) {  return function(b2) {    return b1 || b2;  };};
    function boolNot(b) {  return !b;};
    function concatString(s1) {  return function(s2) {    return s1 + s2;  };};
    var Unit = function (x) {
        return x;
    };
    var Semigroupoid = function ($less$less$less) {
        this["<<<"] = $less$less$less;
    };
    var Functor = function ($less$dollar$greater) {
        this["<$>"] = $less$dollar$greater;
    };
    var Apply = function ($less$times$greater, __superclass_Prelude$dotFunctor_0) {
        this["<*>"] = $less$times$greater;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    var Applicative = function (__superclass_Prelude$dotApply_0, pure) {
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
        this.pure = pure;
    };
    var Bind = function ($greater$greater$eq, __superclass_Prelude$dotApply_0) {
        this[">>="] = $greater$greater$eq;
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
    };
    var Monad = function (__superclass_Prelude$dotApplicative_0, __superclass_Prelude$dotBind_1) {
        this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
        this["__superclass_Prelude.Bind_1"] = __superclass_Prelude$dotBind_1;
    };
    var Eq = function ($div$eq, $eq$eq) {
        this["/="] = $div$eq;
        this["=="] = $eq$eq;
    };
    var BoolLike = function ($amp$amp, not, $bar$bar) {
        this["&&"] = $amp$amp;
        this.not = not;
        this["||"] = $bar$bar;
    };
    var Semigroup = function ($less$greater) {
        this["<>"] = $less$greater;
    };
    var $bar$bar = function (dict) {
        return dict["||"];
    };
    var $greater$greater$eq = function (dict) {
        return dict[">>="];
    };
    var $eq$eq = function (dict) {
        return dict["=="];
    };
    var $less$greater = function (dict) {
        return dict["<>"];
    };
    var $less$less$less = function (dict) {
        return dict["<<<"];
    };
    var $less$times$greater = function (dict) {
        return dict["<*>"];
    };
    var $less$dollar$greater = function (dict) {
        return dict["<$>"];
    };
    var $less$hash$greater = function (__dict_Functor_1) {
        return function (fa) {
            return function (f) {
                return $less$dollar$greater(__dict_Functor_1)(f)(fa);
            };
        };
    };
    var $colon = cons;
    var $plus$plus = function (__dict_Semigroup_2) {
        return $less$greater(__dict_Semigroup_2);
    };
    var $dollar = function (f) {
        return function (x) {
            return f(x);
        };
    };
    var $hash = function (x) {
        return function (f) {
            return f(x);
        };
    };
    var unit = {};
    var semigroupoidArr = new Semigroupoid(function (f) {
        return function (g) {
            return function (x) {
                return f(g(x));
            };
        };
    });
    var semigroupString = new Semigroup(concatString);
    var pure = function (dict) {
        return dict.pure;
    };
    var $$return = function (__dict_Monad_5) {
        return pure(__dict_Monad_5["__superclass_Prelude.Applicative_0"]());
    };
    var otherwise = true;
    var liftA1 = function (__dict_Applicative_7) {
        return function (f) {
            return function (a) {
                return $less$times$greater(__dict_Applicative_7["__superclass_Prelude.Apply_0"]())(pure(__dict_Applicative_7)(f))(a);
            };
        };
    };
    var flip = function (f) {
        return function (b) {
            return function (a) {
                return f(a)(b);
            };
        };
    };
    var eqString = new Eq(refIneq, refEq);
    var $$const = function (_14) {
        return function (_15) {
            return _14;
        };
    };
    var $$void = function (__dict_Functor_9) {
        return function (fa) {
            return $less$dollar$greater(__dict_Functor_9)($$const(unit))(fa);
        };
    };
    var boolLikeBoolean = new BoolLike(boolAnd, boolNot, boolOr);
    var ap = function (__dict_Monad_15) {
        return function (f) {
            return function (a) {
                return $greater$greater$eq(__dict_Monad_15["__superclass_Prelude.Bind_1"]())(f)(function (_2) {
                    return $greater$greater$eq(__dict_Monad_15["__superclass_Prelude.Bind_1"]())(a)(function (_1) {
                        return $$return(__dict_Monad_15)(_2(_1));
                    });
                });
            };
        };
    };
    return {
        Unit: Unit, 
        Semigroup: Semigroup, 
        BoolLike: BoolLike, 
        Eq: Eq, 
        Monad: Monad, 
        Bind: Bind, 
        Applicative: Applicative, 
        Apply: Apply, 
        Functor: Functor, 
        Semigroupoid: Semigroupoid, 
        unit: unit, 
        "++": $plus$plus, 
        "<>": $less$greater, 
        "||": $bar$bar, 
        refIneq: refIneq, 
        refEq: refEq, 
        "==": $eq$eq, 
        ap: ap, 
        "return": $$return, 
        ">>=": $greater$greater$eq, 
        liftA1: liftA1, 
        pure: pure, 
        "<*>": $less$times$greater, 
        "void": $$void, 
        "<#>": $less$hash$greater, 
        "<$>": $less$dollar$greater, 
        cons: cons, 
        ":": $colon, 
        "#": $hash, 
        "$": $dollar, 
        "<<<": $less$less$less, 
        "const": $$const, 
        flip: flip, 
        otherwise: otherwise, 
        semigroupoidArr: semigroupoidArr, 
        eqString: eqString, 
        boolLikeBoolean: boolLikeBoolean, 
        semigroupString: semigroupString
    };
})();
var PS = PS || {};
PS.Data_Function = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function runFn2(fn) {  return function(a) {    return function(b) {      return fn(a, b);    };  };};
    function runFn3(fn) {  return function(a) {    return function(b) {      return function(c) {        return fn(a, b, c);      };    };  };};
    function runFn4(fn) {  return function(a) {    return function(b) {      return function(c) {        return function(d) {          return fn(a, b, c, d);        };      };    };  };};
    return {
        runFn4: runFn4, 
        runFn3: runFn3, 
        runFn2: runFn2
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function returnE(a) {  return function() {    return a;  };};
    function bindE(a) {  return function(f) {    return function() {      return f(a())();    };  };};
    var monadEff = new Prelude.Monad(function () {
        return applicativeEff;
    }, function () {
        return bindEff;
    });
    var bindEff = new Prelude.Bind(bindE, function () {
        return applyEff;
    });
    var applyEff = new Prelude.Apply(Prelude.ap(monadEff), function () {
        return functorEff;
    });
    var applicativeEff = new Prelude.Applicative(function () {
        return applyEff;
    }, returnE);
    var functorEff = new Prelude.Functor(Prelude.liftA1(applicativeEff));
    return {
        bindE: bindE, 
        returnE: returnE, 
        functorEff: functorEff, 
        applyEff: applyEff, 
        applicativeEff: applicativeEff, 
        bindEff: bindEff, 
        monadEff: monadEff
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_AJAX = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    function get(uri) {  return function(k) {    return function() {      var req = new XMLHttpRequest();      req.onreadystatechange = function() {        if (req.readyState === 4 && req.status === 200) {          k(req.responseText)();        }      };      req.open('GET', uri, true);      req.send();    };  };};
    return {
        get: get
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_History = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    function locationProtocol() {  return window.location.protocol;};
    function locationHost() {  return window.location.host;};
    function locationPathname() {  return window.location.pathname;};
    function locationSearch() {  return window.location.search;};
    function replaceHistoryState(data) {  return function(title) {    return function(url) {      return function() {        window.history.replaceState(data, title, url);      };    };  };};
    return {
        replaceHistoryState: replaceHistoryState, 
        locationSearch: locationSearch, 
        locationPathname: locationPathname, 
        locationHost: locationHost, 
        locationProtocol: locationProtocol
    };
})();
var PS = PS || {};
PS.Data_Either = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Left = (function () {
        function Left(value0) {
            this.value0 = value0;
        };
        Left.create = function (value0) {
            return new Left(value0);
        };
        return Left;
    })();
    var Right = (function () {
        function Right(value0) {
            this.value0 = value0;
        };
        Right.create = function (value0) {
            return new Right(value0);
        };
        return Right;
    })();
    var functorEither = new Prelude.Functor(function (_59) {
        return function (_60) {
            if (_60 instanceof Left) {
                return new Left(_60.value0);
            };
            if (_60 instanceof Right) {
                return new Right(_59(_60.value0));
            };
            throw new Error("Failed pattern match");
        };
    });
    var either = function (_56) {
        return function (_57) {
            return function (_58) {
                if (_58 instanceof Left) {
                    return _56(_58.value0);
                };
                if (_58 instanceof Right) {
                    return _57(_58.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var applyEither = new Prelude.Apply(function (_61) {
        return function (_62) {
            if (_61 instanceof Left) {
                return new Left(_61.value0);
            };
            if (_61 instanceof Right) {
                return Prelude["<$>"](functorEither)(_61.value0)(_62);
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return functorEither;
    });
    var bindEither = new Prelude.Bind(either(function (e) {
        return function (_) {
            return new Left(e);
        };
    })(function (a) {
        return function (f) {
            return f(a);
        };
    }), function () {
        return applyEither;
    });
    var applicativeEither = new Prelude.Applicative(function () {
        return applyEither;
    }, Right.create);
    return {
        Left: Left, 
        Right: Right, 
        either: either, 
        functorEither: functorEither, 
        applyEither: applyEither, 
        applicativeEither: applicativeEither, 
        bindEither: bindEither
    };
})();
var PS = PS || {};
PS.Data_Maybe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Extend = PS.Control_Extend;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Control_Plus = PS.Control_Plus;
    var Nothing = (function () {
        function Nothing() {

        };
        Nothing.value = new Nothing();
        return Nothing;
    })();
    var Just = (function () {
        function Just(value0) {
            this.value0 = value0;
        };
        Just.create = function (value0) {
            return new Just(value0);
        };
        return Just;
    })();
    var maybe = function (_70) {
        return function (_71) {
            return function (_72) {
                if (_72 instanceof Nothing) {
                    return _70;
                };
                if (_72 instanceof Just) {
                    return _71(_72.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    return {
        Nothing: Nothing, 
        Just: Just, 
        maybe: maybe
    };
})();
var PS = PS || {};
PS.Data_Array = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Control_Alternative = PS.Control_Alternative;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Prelude_Unsafe = PS.Prelude_Unsafe;
    function length (xs) {  return xs.length;};
    function map (f) {  return function (arr) {    var l = arr.length;    var result = new Array(l);    for (var i = 0; i < l; i++) {      result[i] = f(arr[i]);    }    return result;  };};
    function range (start) {  return function (end) {    var i = ~~start, e = ~~end;    var step = i > e ? -1 : 1;    var result = [i], n = 1;    while (i !== e) {      i += step;      result[n++] = i;    }    return result;  };};
    function zipWith (f) {  return function (xs) {    return function (ys) {      var l = xs.length < ys.length ? xs.length : ys.length;      var result = new Array(l);      for (var i = 0; i < l; i++) {        result[i] = f(xs[i])(ys[i]);      }      return result;    };  };};
    var $$null = function (_94) {
        if (_94.length === 0) {
            return true;
        };
        return false;
    };
    var functorArray = new Prelude.Functor(map);
    return {
        zipWith: zipWith, 
        range: range, 
        length: length, 
        map: map, 
        "null": $$null, 
        functorArray: functorArray
    };
})();
var PS = PS || {};
PS.Data_Foreign = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Function = PS.Data_Function;
    var Data_Array = PS.Data_Array;
    var Data_Either = PS.Data_Either;
    
  function parseJSONImpl(left, right, str) {
    try {
      return right(JSON.parse(str));
    } catch (e) {
      return left(e.toString());
    }
  }
  ;
    
  function unsafeFromForeign(value) {
    return value;
  }
  ;
    
  function typeOf(value) {
    return typeof value;
  }
  ;
    
  function tagOf(value) {
    return Object.prototype.toString.call(value).slice(8, -1);
  }
  ;
    
  function isNull(value) {
    return value === null;
  }
  ;
    
  function isUndefined(value) {
    return value === undefined;
  }
  ;
    
  var isArray = Array.isArray || function(value) {
    return Object.prototype.toString.call(value) === '[object Array]';
  };
  ;
    var TypeMismatch = (function () {
        function TypeMismatch(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        TypeMismatch.create = function (value0) {
            return function (value1) {
                return new TypeMismatch(value0, value1);
            };
        };
        return TypeMismatch;
    })();
    var ErrorAtIndex = (function () {
        function ErrorAtIndex(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        ErrorAtIndex.create = function (value0) {
            return function (value1) {
                return new ErrorAtIndex(value0, value1);
            };
        };
        return ErrorAtIndex;
    })();
    var ErrorAtProperty = (function () {
        function ErrorAtProperty(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        ErrorAtProperty.create = function (value0) {
            return function (value1) {
                return new ErrorAtProperty(value0, value1);
            };
        };
        return ErrorAtProperty;
    })();
    var JSONError = (function () {
        function JSONError(value0) {
            this.value0 = value0;
        };
        JSONError.create = function (value0) {
            return new JSONError(value0);
        };
        return JSONError;
    })();
    var unsafeReadPrim = function (_111) {
        return function (_112) {
            if (tagOf(_112) === _111) {
                return Prelude.pure(Data_Either.applicativeEither)(unsafeFromForeign(_112));
            };
            return new Data_Either.Left(new TypeMismatch(_111, tagOf(_112)));
        };
    };
    var readString = unsafeReadPrim("String");
    var readArray = function (_113) {
        if (isArray(_113)) {
            return Prelude.pure(Data_Either.applicativeEither)(unsafeFromForeign(_113));
        };
        return new Data_Either.Left(new TypeMismatch("array", tagOf(_113)));
    };
    var parseJSON = function (json) {
        return parseJSONImpl(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Either.Left.create)(JSONError.create), Data_Either.Right.create, json);
    };
    return {
        TypeMismatch: TypeMismatch, 
        ErrorAtIndex: ErrorAtIndex, 
        ErrorAtProperty: ErrorAtProperty, 
        JSONError: JSONError, 
        readArray: readArray, 
        readString: readString, 
        isArray: isArray, 
        isUndefined: isUndefined, 
        isNull: isNull, 
        tagOf: tagOf, 
        typeOf: typeOf, 
        unsafeFromForeign: unsafeFromForeign, 
        parseJSON: parseJSON
    };
})();
var PS = PS || {};
PS.Data_Foreign_Index = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Data_Foreign = PS.Data_Foreign;
    var Prelude = PS.Prelude;
    var Data_Either = PS.Data_Either;
    
  function unsafeReadPropImpl(f, s, key, value) {
    return value == null ? f : s(value[key]);
  }
  ;
    
  function unsafeHasOwnProperty(prop, value) {
    return Object.prototype.hasOwnProperty.call(value, prop);
  }
  ;
    
  function unsafeHasProperty(prop, value) {
    return prop in value;
  }
  ;
    var Index = function ($bang, errorAt, hasOwnProperty, hasProperty) {
        this["!"] = $bang;
        this.errorAt = errorAt;
        this.hasOwnProperty = hasOwnProperty;
        this.hasProperty = hasProperty;
    };
    var $bang = function (dict) {
        return dict["!"];
    };
    var unsafeReadProp = function (k) {
        return function (value) {
            return unsafeReadPropImpl(new Data_Either.Left(new Data_Foreign.TypeMismatch("object", Data_Foreign.typeOf(value))), Prelude.pure(Data_Either.applicativeEither), k, value);
        };
    };
    var prop = unsafeReadProp;
    var hasPropertyImpl = function (_119) {
        return function (_120) {
            if (Data_Foreign.isNull(_120)) {
                return false;
            };
            if (Data_Foreign.isUndefined(_120)) {
                return false;
            };
            if (Data_Foreign.typeOf(_120) === "object" || Data_Foreign.typeOf(_120) === "function") {
                return unsafeHasProperty(_119, _120);
            };
            return false;
        };
    };
    var hasOwnPropertyImpl = function (_117) {
        return function (_118) {
            if (Data_Foreign.isNull(_118)) {
                return false;
            };
            if (Data_Foreign.isUndefined(_118)) {
                return false;
            };
            if (Data_Foreign.typeOf(_118) === "object" || Data_Foreign.typeOf(_118) === "function") {
                return unsafeHasOwnProperty(_117, _118);
            };
            return false;
        };
    };
    var indexString = new Index(Prelude.flip(prop), Data_Foreign.ErrorAtProperty.create, hasOwnPropertyImpl, hasPropertyImpl);
    var errorAt = function (dict) {
        return dict.errorAt;
    };
    return {
        Index: Index, 
        errorAt: errorAt, 
        "!": $bang, 
        prop: prop, 
        indexString: indexString
    };
})();
var PS = PS || {};
PS.Data_Monoid = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Maybe = PS.Data_Maybe;
    var mempty = function (dict) {
        return dict.mempty;
    };
    return {
        mempty: mempty
    };
})();
var PS = PS || {};
PS.Data_Foldable = (function () {
    "use strict";
    var Data_Monoid = PS.Data_Monoid;
    var Prelude = PS.Prelude;
    var Control_Apply = PS.Control_Apply;
    var Data_Monoid_First = PS.Data_Monoid_First;
    var Data_Either = PS.Data_Either;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Tuple = PS.Data_Tuple;
    
  function foldrArray(f) {
    return function(z) {
      return function(xs) {
        var acc = z;
        for (var i = xs.length - 1; i >= 0; --i) {
          acc = f(xs[i])(acc);
        }
        return acc;
      }
    }
  };
    
  function foldlArray(f) {
    return function(z) {
      return function(xs) {
        var acc = z;
        for (var i = 0, len = xs.length; i < len; ++i) {
          acc = f(acc)(xs[i]);
        }
        return acc;
      }
    }
  };
    var Foldable = function (foldMap, foldl, foldr) {
        this.foldMap = foldMap;
        this.foldl = foldl;
        this.foldr = foldr;
    };
    var foldr = function (dict) {
        return dict.foldr;
    };
    var foldableArray = new Foldable(function (__dict_Monoid_111) {
        return function (f) {
            return function (xs) {
                return foldr(foldableArray)(function (x) {
                    return function (acc) {
                        return Prelude["<>"](__dict_Monoid_111["__superclass_Prelude.Semigroup_0"]())(f(x))(acc);
                    };
                })(Data_Monoid.mempty(__dict_Monoid_111))(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldlArray(f)(z)(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldrArray(f)(z)(xs);
            };
        };
    });
    return {
        Foldable: Foldable, 
        foldlArray: foldlArray, 
        foldrArray: foldrArray, 
        foldr: foldr, 
        foldableArray: foldableArray
    };
})();
var PS = PS || {};
PS.Data_String = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Data_Char = PS.Data_Char;
    var Data_String_Unsafe = PS.Data_String_Unsafe;
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    
    function drop(n) {
      return function(s) {
        return s.substr(n);
      };
    }
    ;
    return {
        drop: drop
    };
})();
var PS = PS || {};
PS.Data_Traversable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Either = PS.Data_Either;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Maybe = PS.Data_Maybe;
    var Traversable = function (__superclass_Data$dotFoldable$dotFoldable_1, __superclass_Prelude$dotFunctor_0, sequence, traverse) {
        this["__superclass_Data.Foldable.Foldable_1"] = __superclass_Data$dotFoldable$dotFoldable_1;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
        this.sequence = sequence;
        this.traverse = traverse;
    };
    var traverse = function (dict) {
        return dict.traverse;
    };
    var sequence = function (dict) {
        return dict.sequence;
    };
    var traversableArray = new Traversable(function () {
        return Data_Foldable.foldableArray;
    }, function () {
        return Data_Array.functorArray;
    }, function (__dict_Applicative_134) {
        return function (_267) {
            if (_267.length === 0) {
                return Prelude.pure(__dict_Applicative_134)([  ]);
            };
            if (_267.length >= 1) {
                var _323 = _267.slice(1);
                return Prelude["<*>"](__dict_Applicative_134["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_134["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_267[0]))(sequence(traversableArray)(__dict_Applicative_134)(_323));
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_133) {
        return function (_265) {
            return function (_266) {
                if (_266.length === 0) {
                    return Prelude.pure(__dict_Applicative_133)([  ]);
                };
                if (_266.length >= 1) {
                    var _327 = _266.slice(1);
                    return Prelude["<*>"](__dict_Applicative_133["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_133["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_265(_266[0])))(traverse(traversableArray)(__dict_Applicative_133)(_265)(_327));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    return {
        Traversable: Traversable, 
        sequence: sequence, 
        traverse: traverse, 
        traversableArray: traversableArray
    };
})();
var PS = PS || {};
PS.Data_Foreign_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Foreign = PS.Data_Foreign;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Array = PS.Data_Array;
    var Data_Foreign_Null = PS.Data_Foreign_Null;
    var Data_Foreign_Undefined = PS.Data_Foreign_Undefined;
    var Data_Foreign_NullOrUndefined = PS.Data_Foreign_NullOrUndefined;
    var Data_Either = PS.Data_Either;
    var Data_Foreign_Index = PS.Data_Foreign_Index;
    var IsForeign = function (read) {
        this.read = read;
    };
    var stringIsForeign = new IsForeign(Data_Foreign.readString);
    var read = function (dict) {
        return dict.read;
    };
    var readWith = function (__dict_IsForeign_143) {
        return function (f) {
            return function (value) {
                return Data_Either.either(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Either.Left.create)(f))(Data_Either.Right.create)(read(__dict_IsForeign_143)(value));
            };
        };
    };
    var readProp = function (__dict_IsForeign_144) {
        return function (__dict_Index_145) {
            return function (prop) {
                return function (value) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Index["!"](__dict_Index_145)(value)(prop))(readWith(__dict_IsForeign_144)(Data_Foreign_Index.errorAt(__dict_Index_145)(prop)));
                };
            };
        };
    };
    var arrayIsForeign = function (__dict_IsForeign_149) {
        return new IsForeign(function (value) {
            var readElement = function (i) {
                return function (value_1) {
                    return readWith(__dict_IsForeign_149)(Data_Foreign.ErrorAtIndex.create(i))(value_1);
                };
            };
            var readElements = function (arr) {
                return Data_Traversable.sequence(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(Data_Array.zipWith(readElement)(Data_Array.range(0)(Data_Array.length(arr)))(arr));
            };
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign.readArray(value))(readElements);
        });
    };
    return {
        IsForeign: IsForeign, 
        readProp: readProp, 
        readWith: readWith, 
        read: read, 
        stringIsForeign: stringIsForeign, 
        arrayIsForeign: arrayIsForeign
    };
})();
var PS = PS || {};
PS.Thermite_Types = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var Spec = function (x) {
        return x;
    };
    return {
        Spec: Spec
    };
})();
var PS = PS || {};
PS.Thermite_Internal = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var DOM = PS.DOM;
    var Data_Maybe = PS.Data_Maybe;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Thermite_Types = PS.Thermite_Types;
    
  function getStateImpl(ctx) {
    return function() {
      return ctx.state;
    };
  }
  ;
    
  function setStateImpl(ctx) {
    return function(state) {
      return function() {
        ctx.setState(state);
      };
    };
  } 
  ;
    
  function textImpl(s) {
    return s;
  }
  ;
    
  function createElementImpl(name) {
    return function(ps) {
      return function(children) {
        var props = {};

        for (var i = 0; i < ps.length; i++) {
          var p = ps[i];
          props[p[0]] = p[1];
        }

        return React.createElement(name, props, children);
      };
    };
  }
  ;
    
  function unsafeAttribute(attr) {
    return function(value) {
      return [attr, value];
    };
  }   
  ;
    
  function event(name) {
    return function(context) {
      return function(f) {
        return [name, function(e) {
          context.performAction(f(e));
        }];
      };
    };
  }
  ;
    
  function createClassImpl(runAction) {
    return function(maybe) {
      return function(spec) {
        return React.createClass({
          getInitialState: function() {
            return spec.initialState;
          },
          performAction: function(action) {
            runAction(this)(spec.performAction(this)(action))();
          },
          render: function() {
            return spec.render(this)(this.state)(this.props);
          },
          componentWillMount: function() {
            var self = this;
            maybe(function() { })(function(action) {
              return function() {
                self.performAction(action);
              };
            })(spec.componentWillMount)();
          }
        });
      };
    }; 
  }
  ;
    
  function renderImpl(component) {
    return function(props) {
      return function() {
        React.render(React.createElement(component, props), document.body);
      };
    };
  }
  ;
    return {
        renderImpl: renderImpl, 
        createClassImpl: createClassImpl, 
        event: event, 
        unsafeAttribute: unsafeAttribute, 
        createElementImpl: createElementImpl, 
        textImpl: textImpl, 
        setStateImpl: setStateImpl, 
        getStateImpl: getStateImpl
    };
})();
var PS = PS || {};
PS.Thermite_Action = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Thermite_Internal = PS.Thermite_Internal;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Thermite_Types = PS.Thermite_Types;
    var GetState = (function () {
        function GetState(value0) {
            this.value0 = value0;
        };
        GetState.create = function (value0) {
            return new GetState(value0);
        };
        return GetState;
    })();
    var SetState = (function () {
        function SetState(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        SetState.create = function (value0) {
            return function (value1) {
                return new SetState(value0, value1);
            };
        };
        return SetState;
    })();
    var Wait = (function () {
        function Wait(value0) {
            this.value0 = value0;
        };
        Wait.create = function (value0) {
            return new Wait(value0);
        };
        return Wait;
    })();
    var Pure = (function () {
        function Pure(value0) {
            this.value0 = value0;
        };
        Pure.create = function (value0) {
            return new Pure(value0);
        };
        return Pure;
    })();
    var Impure = (function () {
        function Impure(value0) {
            this.value0 = value0;
        };
        Impure.create = function (value0) {
            return new Impure(value0);
        };
        return Impure;
    })();
    var setState = function (s) {
        return Impure.create(new SetState(s, new Pure(Prelude.unit)));
    };
    var runAction = function (ctx) {
        var go = function (_279) {
            if (_279 instanceof Pure) {
                return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
            };
            if (_279 instanceof Impure && _279.value0 instanceof GetState) {
                return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
                    var _5 = Thermite_Internal.getStateImpl(ctx)();
                    return go(_279.value0.value0(_5))();
                });
            };
            if (_279 instanceof Impure && _279.value0 instanceof SetState) {
                return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
                    Thermite_Internal.setStateImpl(ctx)(_279.value0.value0)();
                    return go(_279.value0.value1)();
                });
            };
            if (_279 instanceof Impure && _279.value0 instanceof Wait) {
                return _279.value0.value0(go);
            };
            throw new Error("Failed pattern match");
        };
        return go;
    };
    var getState = Impure.create(new GetState(Pure.create));
    var functorActionF = new Prelude.Functor(function (_277) {
        return function (_278) {
            if (_278 instanceof GetState) {
                return new GetState(Prelude["<<<"](Prelude.semigroupoidArr)(_277)(_278.value0));
            };
            if (_278 instanceof SetState) {
                return new SetState(_278.value0, _277(_278.value1));
            };
            if (_278 instanceof Wait) {
                return new Wait(function (k_1) {
                    return _278.value0(Prelude["<<<"](Prelude.semigroupoidArr)(k_1)(_277));
                });
            };
            throw new Error("Failed pattern match");
        };
    });
    var functorAction = new Prelude.Functor(function (_280) {
        return function (_281) {
            if (_281 instanceof Pure) {
                return new Pure(_280(_281.value0));
            };
            if (_281 instanceof Impure) {
                return new Impure(Prelude["<$>"](functorActionF)(Prelude["<$>"](functorAction)(_280))(_281.value0));
            };
            throw new Error("Failed pattern match");
        };
    });
    var async = function (c) {
        return Impure.create(new Wait(function (k) {
            return c(Prelude["<<<"](Prelude.semigroupoidArr)(k)(Pure.create));
        }));
    };
    var sync = function (e) {
        return async(Prelude[">>="](Control_Monad_Eff.bindEff)(e));
    };
    var monadAction = new Prelude.Monad(function () {
        return applicativeAction;
    }, function () {
        return bindAction;
    });
    var bindAction = new Prelude.Bind(function (_282) {
        return function (_283) {
            if (_282 instanceof Pure) {
                return _283(_282.value0);
            };
            if (_282 instanceof Impure) {
                return Impure.create(Prelude["<#>"](functorActionF)(_282.value0)(function (a_1) {
                    return Prelude[">>="](bindAction)(a_1)(_283);
                }));
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return applyAction;
    });
    var applyAction = new Prelude.Apply(Prelude.ap(monadAction), function () {
        return functorAction;
    });
    var applicativeAction = new Prelude.Applicative(function () {
        return applyAction;
    }, Pure.create);
    var modifyState = function (f) {
        return Prelude[">>="](bindAction)(getState)(function (_6) {
            return setState(f(_6));
        });
    };
    return {
        async: async, 
        sync: sync, 
        modifyState: modifyState, 
        setState: setState, 
        getState: getState, 
        runAction: runAction, 
        functorAction: functorAction, 
        applyAction: applyAction, 
        applicativeAction: applicativeAction, 
        bindAction: bindAction, 
        monadAction: monadAction
    };
})();
var PS = PS || {};
PS.Thermite_Events = (function () {
    "use strict";
    var Thermite_Internal = PS.Thermite_Internal;
    var Prelude = PS.Prelude;
    var Thermite_Types = PS.Thermite_Types;
    var onKeyUp = Thermite_Internal.event("onKeyUp");
    var onChange = Thermite_Internal.event("onChange");
    var onBlur = Thermite_Internal.event("onBlur");
    return {
        onChange: onChange, 
        onBlur: onBlur, 
        onKeyUp: onKeyUp
    };
})();
var PS = PS || {};
PS.Thermite_Html = (function () {
    "use strict";
    var Thermite_Internal = PS.Thermite_Internal;
    var Prelude = PS.Prelude;
    var Thermite_Types = PS.Thermite_Types;
    var text = Thermite_Internal.textImpl;
    return {
        text: text
    };
})();
var PS = PS || {};
PS.Thermite = (function () {
    "use strict";
    var Thermite_Internal = PS.Thermite_Internal;
    var Thermite_Action = PS.Thermite_Action;
    var Data_Maybe = PS.Data_Maybe;
    var Prelude = PS.Prelude;
    var DOM = PS.DOM;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Thermite_Html = PS.Thermite_Html;
    var Thermite_Types = PS.Thermite_Types;
    var simpleSpec = function (initialState) {
        return function (performAction) {
            return function (render_1) {
                return {
                    initialState: initialState, 
                    performAction: performAction, 
                    render: render_1, 
                    componentWillMount: Data_Maybe.Nothing.value
                };
            };
        };
    };
    var render = Thermite_Internal.renderImpl;
    var createClass = Thermite_Internal.createClassImpl(Thermite_Action.runAction)(Data_Maybe.maybe);
    var componentWillMount = function (_284) {
        return function (_285) {
            var _355 = {};
            for (var _356 in _285) {
                if (_285.hasOwnProperty(_356)) {
                    _355[_356] = _285[_356];
                };
            };
            _355.componentWillMount = new Data_Maybe.Just(_284);
            return _355;
        };
    };
    return {
        render: render, 
        createClass: createClass, 
        componentWillMount: componentWillMount, 
        simpleSpec: simpleSpec
    };
})();
var PS = PS || {};
PS.Thermite_Html_Attributes = (function () {
    "use strict";
    var Thermite_Internal = PS.Thermite_Internal;
    var Prelude = PS.Prelude;
    var Thermite_Types = PS.Thermite_Types;
    var value = Thermite_Internal.unsafeAttribute("value");
    var placeholder = Thermite_Internal.unsafeAttribute("placeholder");
    var href = Thermite_Internal.unsafeAttribute("href");
    var className = Thermite_Internal.unsafeAttribute("className");
    var autoFocus = Thermite_Internal.unsafeAttribute("autoFocus");
    var _type = Thermite_Internal.unsafeAttribute("type");
    return {
        value: value, 
        _type: _type, 
        placeholder: placeholder, 
        href: href, 
        className: className, 
        autoFocus: autoFocus
    };
})();
var PS = PS || {};
PS.Thermite_Html_Elements = (function () {
    "use strict";
    var Thermite_Internal = PS.Thermite_Internal;
    var Prelude = PS.Prelude;
    var Thermite_Types = PS.Thermite_Types;
    var pre = Thermite_Internal.createElementImpl("pre");
    var pre$prime = pre([  ]);
    var p = Thermite_Internal.createElementImpl("p");
    var p$prime = p([  ]);
    var input = Thermite_Internal.createElementImpl("input");
    var h2 = Thermite_Internal.createElementImpl("h2");
    var h2$prime = h2([  ]);
    var h1 = Thermite_Internal.createElementImpl("h1");
    var h1$prime = h1([  ]);
    var div = Thermite_Internal.createElementImpl("div");
    var div$prime = div([  ]);
    var code = Thermite_Internal.createElementImpl("code");
    var code$prime = code([  ]);
    var a = Thermite_Internal.createElementImpl("a");
    return {
        "pre'": pre$prime, 
        pre: pre, 
        "p'": p$prime, 
        p: p, 
        input: input, 
        "h2'": h2$prime, 
        h2: h2, 
        "h1'": h1$prime, 
        h1: h1, 
        "div'": div$prime, 
        div: div, 
        "code'": code$prime, 
        code: code, 
        a: a
    };
})();
var PS = PS || {};
PS.Main = (function () {
    "use strict";
    var Data_Foreign_Class = PS.Data_Foreign_Class;
    var Thermite_Html_Elements = PS.Thermite_Html_Elements;
    var Thermite_Html_Attributes = PS.Thermite_Html_Attributes;
    var Thermite_Html = PS.Thermite_Html;
    var Data_Array = PS.Data_Array;
    var Prelude = PS.Prelude;
    var Thermite_Events = PS.Thermite_Events;
    var Thermite_Action = PS.Thermite_Action;
    var Data_String = PS.Data_String;
    var Control_Monad_Eff_History = PS.Control_Monad_Eff_History;
    var Control_Monad_Eff_AJAX = PS.Control_Monad_Eff_AJAX;
    var Data_Foreign = PS.Data_Foreign;
    var Thermite = PS.Thermite;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Either = PS.Data_Either;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Traversable = PS.Data_Traversable;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Thermite_Types = PS.Thermite_Types;
    var Data_Foreign_Index = PS.Data_Foreign_Index;
    function getValue(e) {  return e.target.value;};
    function getKeyCode(e) {  return e.keyCode;};
    var Entry = (function () {
        function Entry(value0, value1, value2) {
            this.value0 = value0;
            this.value1 = value1;
            this.value2 = value2;
        };
        Entry.create = function (value0) {
            return function (value1) {
                return function (value2) {
                    return new Entry(value0, value1, value2);
                };
            };
        };
        return Entry;
    })();
    var Change = (function () {
        function Change(value0) {
            this.value0 = value0;
        };
        Change.create = function (value0) {
            return new Change(value0);
        };
        return Change;
    })();
    var Search = (function () {
        function Search(value0) {
            this.value0 = value0;
        };
        Search.create = function (value0) {
            return new Search(value0);
        };
        return Search;
    })();
    var ReadQueryString = (function () {
        function ReadQueryString() {

        };
        ReadQueryString.value = new ReadQueryString();
        return ReadQueryString;
    })();
    var DoNothing = (function () {
        function DoNothing() {

        };
        DoNothing.value = new DoNothing();
        return DoNothing;
    })();
    var isForeignEntry = new Data_Foreign_Class.IsForeign(function (entry) {
        return Prelude["<*>"](Data_Either.applyEither)(Prelude["<*>"](Data_Either.applyEither)(Prelude["<$>"](Data_Either.functorEither)(Entry.create)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("module")(entry)))(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("name")(entry)))(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("detail")(entry));
    });
    var search = function (q) {
        var uri = "/search?q=" + q;
        return Prelude[">>="](Thermite_Action.bindAction)(Thermite_Action.async(Control_Monad_Eff_AJAX.get(uri)))(function (_9) {
            return Thermite_Action.setState({
                query: q, 
                lastSearch: q, 
                results: (function () {
                    var _358 = Prelude[">>="](Data_Either.bindEither)(Data_Foreign.parseJSON(_9))(Data_Foreign_Class.read(Data_Foreign_Class.arrayIsForeign(isForeignEntry)));
                    if (_358 instanceof Data_Either.Left) {
                        return [  ];
                    };
                    if (_358 instanceof Data_Either.Right) {
                        return _358.value0;
                    };
                    throw new Error("Failed pattern match");
                })()
            });
        });
    };
    var initialState = {
        lastSearch: "", 
        query: "", 
        results: [  ]
    };
    var handleKey = function (e) {
        var _361 = getKeyCode(e);
        if (_361 === 13) {
            return Search.create(getValue(e));
        };
        return DoNothing.value;
    };
    var handleChange = function (e) {
        return new Change(getValue(e));
    };
    var handleBlur = function (e) {
        return Search.create(getValue(e));
    };
    var render = function (_286) {
        return function (_287) {
            return function (_288) {
                var searchResult = function (_291) {
                    return Thermite_Html_Elements["div'"]([ Thermite_Html_Elements["h2'"]([ Thermite_Html_Elements["code'"]([ Thermite_Html.text(_291.value1) ]) ]), Thermite_Html_Elements["div'"]([ Thermite_Html_Elements["code'"]([ Thermite_Html.text(_291.value0) ]) ]), Thermite_Html_Elements["pre'"]([ Thermite_Html.text(_291.value2) ]) ]);
                };
                var searchResults = (function () {
                    if (_287.lastSearch === "") {
                        return Thermite_Html_Elements["p'"]([ Thermite_Html.text("Enter a search term above.") ]);
                    };
                    if (Data_Array["null"](_287.results)) {
                        return Thermite_Html_Elements["p'"]([ Thermite_Html.text("No results for '" + (_287.lastSearch + "'")) ]);
                    };
                    if (Prelude.otherwise) {
                        return Thermite_Html_Elements["div'"](Prelude["<$>"](Data_Array.functorArray)(searchResult)(_287.results));
                    };
                    throw new Error("Failed pattern match");
                })();
                var header = Thermite_Html_Elements.div([ Thermite_Html_Attributes.className("header") ]);
                var container = Thermite_Html_Elements.div([ Thermite_Html_Attributes.className("container-fluid") ]);
                var body = Thermite_Html_Elements.div([ Thermite_Html_Attributes.className("body") ]);
                return container([ header([ Thermite_Html_Elements["h1'"]([ Thermite_Html.text("Pursuit") ]), Thermite_Html_Elements["div'"]([ Thermite_Html_Elements.input([ Thermite_Html_Attributes._type("search"), Thermite_Html_Attributes.className("form-control"), Thermite_Html_Attributes.placeholder("Search..."), Thermite_Events.onChange(_286)(handleChange), Thermite_Events.onBlur(_286)(handleBlur), Thermite_Events.onKeyUp(_286)(handleKey), Thermite_Html_Attributes.autoFocus(true), Thermite_Html_Attributes.value(_287.query) ])([  ]) ]) ]), body([ searchResults, Thermite_Html_Elements["div'"]([ Thermite_Html_Elements.a([ Thermite_Html_Attributes.href("http://github.com/purescript/pursuit") ])([ Thermite_Html.text("Source") ]), Thermite_Html.text(" | "), Thermite_Html_Elements.a([ Thermite_Html_Attributes.href("http://purescript.org") ])([ Thermite_Html.text("PureScript") ]) ]) ]) ]);
            };
        };
    };
    var baseUrl = function __do() {
        var _12 = Control_Monad_Eff_History.locationProtocol();
        var _11 = Control_Monad_Eff_History.locationHost();
        var _10 = Control_Monad_Eff_History.locationPathname();
        return _12 + ("//" + (_11 + _10));
    };
    var updateHistorySearch = function (query) {
        return function __do() {
            var _13 = baseUrl();
            return Control_Monad_Eff_History.replaceHistoryState({})("PURSuit")(_13 + ("?" + query))();
        };
    };
    var performAction = function (_289) {
        return function (_290) {
            if (_290 instanceof Change) {
                return Thermite_Action.modifyState(function (o) {
                    var _375 = {};
                    for (var _376 in o) {
                        if (o.hasOwnProperty(_376)) {
                            _375[_376] = o[_376];
                        };
                    };
                    _375.query = _290.value0;
                    return _375;
                });
            };
            if (_290 instanceof Search && _290.value0 === "") {
                return Thermite_Action.setState({
                    query: "", 
                    lastSearch: "", 
                    results: [  ]
                });
            };
            if (_290 instanceof Search) {
                return Prelude[">>="](Thermite_Action.bindAction)(Thermite_Action.sync(updateHistorySearch(_290.value0)))(function () {
                    return search(_290.value0);
                });
            };
            if (_290 instanceof ReadQueryString) {
                return Prelude[">>="](Thermite_Action.bindAction)(Prelude["<$>"](Thermite_Action.functorAction)(Data_String.drop(1))(Thermite_Action.sync(Control_Monad_Eff_History.locationSearch)))(function (_8) {
                    return Prelude[">>="](Thermite_Action.bindAction)(Thermite_Action.setState({
                        query: _8, 
                        lastSearch: _8, 
                        results: [  ]
                    }))(function () {
                        if (_8 === "") {
                            return Prelude["return"](Thermite_Action.monadAction)(Prelude.unit);
                        };
                        return search(_8);
                    });
                });
            };
            if (_290 instanceof DoNothing) {
                return Prelude["return"](Thermite_Action.monadAction)(Prelude.unit);
            };
            throw new Error("Failed pattern match");
        };
    };
    var spec = Thermite.componentWillMount(ReadQueryString.value)(Thermite.simpleSpec(initialState)(performAction)(render));
    var main = (function () {
        var component = Thermite.createClass(spec);
        return Thermite.render(component)({});
    })();
    return {
        Change: Change, 
        Search: Search, 
        ReadQueryString: ReadQueryString, 
        DoNothing: DoNothing, 
        Entry: Entry, 
        main: main, 
        spec: spec, 
        updateHistorySearch: updateHistorySearch, 
        baseUrl: baseUrl, 
        search: search, 
        performAction: performAction, 
        render: render, 
        handleBlur: handleBlur, 
        handleKey: handleKey, 
        handleChange: handleChange, 
        getKeyCode: getKeyCode, 
        getValue: getValue, 
        initialState: initialState, 
        isForeignEntry: isForeignEntry
    };
})();
